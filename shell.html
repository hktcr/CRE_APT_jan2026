<!DOCTYPE html>
<html lang="sv">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Slide Shell</title>
    <link
        href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700;900&family=JetBrains+Mono:wght@400;700&display=swap"
        rel="stylesheet">
    <style>
        :root {
            /* Bakgrundsf√§rger - √§ndra h√§r f√∂r att byta tema */
            --bg: #000000;
            /* Helt svart bakgrund */
            --surface: #1a1a1a;
            /* M√∂rkgr√• ytor */
            --card-bg: #2a2a2a;
            /* Kortens bakgrund */
            --card-bg-hover: #333333;
            /* Kort vid hover */

            /* Textf√§rger */
            --text: #f1f5f9;
            --text-muted: rgba(255, 255, 255, 0.7);

            /* Accentf√§rger */
            --accent: #f97316;
            --accent2: #a855f7;
            --green: #22c55e;
            --yellow: #eab308;
            --red: #ef4444;

            /* Ramar */
            --border: rgba(255, 255, 255, 0.15);
            --border-hover: rgba(255, 255, 255, 0.3);
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Inter', sans-serif;
            background: var(--bg);
            color: var(--text);
            min-height: 100vh;
        }

        /* ===== CARD GRID VIEW ===== */
        .card-view {
            padding: 2rem;
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
            gap: 1rem;
            max-width: 1400px;
            margin: 0 auto;
        }

        .card-view.hidden {
            display: none;
        }

        .slide-card {
            aspect-ratio: 16/10;
            background: var(--card-bg);
            border-radius: 12px;
            border: 2px solid var(--border);
            cursor: pointer;
            transition: all 0.3s;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            text-align: center;
            padding: 1rem;
            position: relative;
            overflow: hidden;
        }

        .slide-card:hover {
            border-color: var(--accent);
            transform: translateY(-4px);
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.4);
        }

        .slide-card:first-child {
            border-color: var(--accent);
        }

        .card-icon {
            font-size: 2rem;
            margin-bottom: 0.5rem;
        }

        .card-title {
            font-weight: 600;
            font-size: 0.9rem;
        }

        .card-id {
            position: absolute;
            top: 0.5rem;
            right: 0.5rem;
            font-size: 0.7rem;
            opacity: 0.8;
            font-family: 'JetBrains Mono', monospace;
            background: rgba(0, 0, 0, 0.5);
            padding: 0.2rem 0.5rem;
            border-radius: 4px;
            color: var(--accent);
        }

        .card-type {
            position: absolute;
            top: 0.5rem;
            left: 0.5rem;
            font-size: 0.6rem;
            opacity: 0.5;
            background: rgba(0, 0, 0, 0.3);
            padding: 0.15rem 0.4rem;
            border-radius: 4px;
        }

        /* ===== SLIDE FULLSCREEN VIEW ===== */
        .slide-view {
            position: fixed;
            inset: 0;
            background: var(--bg);
            display: none;
            flex-direction: column;
            z-index: 100;
        }

        .slide-view.active {
            display: flex;
        }

        .slide-content {
            flex: 1;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            padding: 2rem;
            overflow-y: auto;
        }

        .close-btn {
            position: fixed;
            top: 1rem;
            right: 1rem;
            background: rgba(255, 255, 255, 0.1);
            border: none;
            color: white;
            width: 48px;
            height: 48px;
            border-radius: 50%;
            font-size: 1.5rem;
            cursor: pointer;
            z-index: 101;
            transition: all 0.2s;
        }

        .close-btn:hover {
            background: rgba(255, 255, 255, 0.2);
        }

        /* ===== DIMMER BUTTON ===== */
        .dimmer-btn {
            position: fixed;
            top: 1rem;
            right: 5rem;
            background: rgba(255, 255, 255, 0.1);
            border: none;
            color: white;
            width: 48px;
            height: 48px;
            border-radius: 50%;
            font-size: 1.2rem;
            cursor: pointer;
            z-index: 101;
            transition: all 0.3s;
        }

        .dimmer-btn:hover {
            background: rgba(255, 255, 255, 0.2);
        }

        .dimmer-btn.active {
            background: var(--accent);
        }

        .slide-view.dimmed::before {
            content: '';
            position: absolute;
            inset: 0;
            background: rgba(0, 0, 0, 0.7);
            z-index: 1;
            pointer-events: none;
        }

        .slide-view.dimmed .slide-content {
            z-index: 2;
            position: relative;
        }

        .slide-view.dimmed .close-btn,
        .slide-view.dimmed .dimmer-btn {
            z-index: 102;
        }

        .nav-btn {
            display: none;
        }

        .slide-id-display {
            position: fixed;
            bottom: 1rem;
            left: 50%;
            transform: translateX(-50%);
            font-family: 'JetBrains Mono', monospace;
            font-size: 0.8rem;
            opacity: 0.4;
        }

        /* ===== SLIDE TYPE: TITLE ===== */
        .slide-title-type {
            text-align: center;
        }

        .slide-title-type h1 {
            font-size: clamp(2.5rem, 8vw, 5rem);
            font-weight: 900;
            background: linear-gradient(135deg, var(--accent), var(--accent2));
            -webkit-background-clip: text;
            background-clip: text;
            -webkit-text-fill-color: transparent;
            margin-bottom: 1rem;
        }

        .slide-title-type .subtitle {
            font-size: clamp(1.2rem, 3vw, 1.8rem);
            opacity: 0.8;
        }

        .slide-title-type .meta {
            margin-top: 2rem;
            opacity: 0.5;
            font-size: 0.9rem;
        }

        /* ===== SLIDE TYPE: PRESENTER ===== */
        .slide-presenter {
            text-align: center;
            max-width: 800px;
        }

        .slide-presenter .avatar {
            width: 180px;
            height: 180px;
            border-radius: 50%;
            background: linear-gradient(135deg, var(--accent), var(--accent2));
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 4rem;
            margin: 0 auto 2rem;
            overflow: hidden;
        }

        .slide-presenter .avatar img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }

        .slide-presenter h2 {
            font-size: clamp(2.5rem, 5vw, 3.5rem);
            margin-bottom: 0.5rem;
        }

        .slide-presenter .title-org {
            color: var(--accent);
            font-size: clamp(1.3rem, 2.5vw, 1.8rem);
            margin-bottom: 2rem;
        }

        .slide-presenter .bio {
            opacity: 0.9;
            line-height: 1.8;
            font-size: clamp(1.1rem, 2vw, 1.4rem);
        }

        .slide-presenter .contact {
            margin-top: 2rem;
            opacity: 0.6;
            font-size: 1rem;
        }

        /* ===== SLIDE TYPE: STAT ===== */
        .slide-stat {
            text-align: center;
        }

        .slide-stat .stat-value {
            font-size: clamp(6rem, 20vw, 14rem);
            font-weight: 900;
            line-height: 1;
            background: linear-gradient(135deg, #fcd34d, var(--accent));
            -webkit-background-clip: text;
            background-clip: text;
            -webkit-text-fill-color: transparent;
        }

        .slide-stat .stat-label {
            font-size: clamp(1.2rem, 3vw, 1.8rem);
            opacity: 0.9;
            margin-top: 1rem;
            max-width: 700px;
        }

        .slide-stat .stat-source {
            margin-top: 2rem;
            opacity: 0.5;
            font-size: 0.9rem;
        }

        /* ===== SLIDE TYPE: QUOTE ===== */
        .slide-quote {
            max-width: 900px;
            text-align: center;
        }

        .slide-quote.typewriter {
            font-family: 'JetBrains Mono', monospace;
            color: #00ff88;
        }

        .slide-quote .quote-text {
            font-size: clamp(1.4rem, 3.5vw, 2.4rem);
            line-height: 1.6;
        }

        .slide-quote.typewriter .quote-text {
            text-shadow: 0 0 20px rgba(0, 255, 136, 0.3);
        }

        .slide-quote .highlight {
            color: var(--accent);
            font-weight: 700;
        }

        .slide-quote .quote-author {
            margin-top: 2rem;
            opacity: 0.6;
            font-size: 1rem;
            font-family: 'Inter', sans-serif;
        }

        .slide-quote .cursor {
            display: inline-block;
            width: 0.6em;
            height: 1.2em;
            background: currentColor;
            margin-left: 0.2em;
            animation: blink 1s step-end infinite;
            vertical-align: middle;
        }

        @keyframes blink {
            50% {
                opacity: 0;
            }
        }

        /* ===== SLIDE TYPE: GRID ===== */
        .slide-grid {
            text-align: center;
            width: 100%;
            max-width: 1100px;
        }

        .slide-grid h2 {
            font-size: clamp(1.8rem, 4vw, 2.5rem);
            margin-bottom: 2.5rem;
            background: linear-gradient(135deg, var(--accent), var(--accent2));
            -webkit-background-clip: text;
            background-clip: text;
            -webkit-text-fill-color: transparent;
        }

        .grid-cards {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 1.5rem;
        }

        @media (max-width: 768px) {
            .grid-cards {
                grid-template-columns: 1fr;
            }
        }

        .grid-card {
            background: var(--card-bg);
            border-radius: 16px;
            padding: 2rem;
            border: 1px solid var(--border);
            text-align: left;
            transition: all 0.3s;
        }

        .grid-card:hover {
            border-color: var(--accent);
            transform: translateY(-3px);
        }

        .grid-card-icon {
            font-size: 2.5rem;
            margin-bottom: 1rem;
        }

        .grid-card-title {
            font-weight: 700;
            font-size: 1.2rem;
            margin-bottom: 0.8rem;
            color: var(--accent);
        }

        .grid-card-desc {
            font-size: 1rem;
            opacity: 0.85;
            line-height: 1.6;
        }

        /* ===== SLIDE TYPE: QUAD-FLIP ===== */
        .slide-quad {
            text-align: center;
            width: 100%;
            max-width: 900px;
        }

        .slide-quad h2 {
            font-size: 1.8rem;
            color: var(--red);
            margin-bottom: 2rem;
        }

        .quad-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 1rem;
        }

        .quad-card {
            background: var(--card-bg);
            border-radius: 16px;
            padding: 2rem;
            border: 2px solid var(--border);
            cursor: pointer;
            transition: all 0.3s;
            min-height: 180px;
            display: flex;
            flex-direction: column;
            justify-content: center;
        }

        .quad-card:hover {
            border-color: var(--border-hover);
            background: var(--card-bg-hover);
            transform: translateY(-3px);
        }

        .quad-card.flipped {
            background: var(--card-bg-hover);
            border-color: var(--accent);
        }

        .quad-front {
            transition: opacity 0.3s;
        }

        .quad-back {
            display: none;
            font-size: 0.9rem;
            line-height: 1.6;
        }

        .quad-card.flipped .quad-front {
            display: none;
        }

        .quad-card.flipped .quad-back {
            display: block;
        }

        .quad-icon {
            font-size: 2rem;
            margin-bottom: 0.5rem;
        }

        .quad-title {
            font-weight: 700;
            font-size: 1.1rem;
        }

        /* ===== SLIDE TYPE: MODAL-CARDS ===== */
        .slide-modal-cards {
            text-align: center;
            width: 100%;
            max-width: 1100px;
        }

        .slide-modal-cards h2 {
            font-size: clamp(1.8rem, 4vw, 2.5rem);
            margin-bottom: 2.5rem;
            background: linear-gradient(135deg, var(--accent), var(--accent2));
            -webkit-background-clip: text;
            background-clip: text;
            -webkit-text-fill-color: transparent;
        }

        .modal-cards-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 1.5rem;
        }

        .modal-card {
            background: var(--card-bg);
            border-radius: 16px;
            padding: 2rem;
            border: 2px solid var(--border);
            cursor: pointer;
            transition: all 0.3s;
            text-align: center;
        }

        .modal-card:hover {
            border-color: var(--accent);
            background: var(--card-bg-hover);
            transform: translateY(-4px);
        }

        .modal-card-icon {
            font-size: 3rem;
            margin-bottom: 1rem;
        }

        .modal-card-icon img {
            width: 80px;
            height: 80px;
            object-fit: contain;
        }

        .modal-card-title {
            font-weight: 700;
            font-size: 1.3rem;
        }

        .card-modal-content {
            text-align: left;
        }

        .card-modal-content h3 {
            font-size: 1.8rem;
            margin-bottom: 1.5rem;
            color: var(--accent);
        }

        .card-modal-icon {
            float: right;
            margin-left: 1.5rem;
            font-size: 4rem;
        }

        .card-modal-icon img {
            width: 120px;
            height: 120px;
            object-fit: contain;
        }

        .card-modal-text {
            font-size: 1.1rem;
            line-height: 1.8;
        }

        .card-modal-text strong {
            color: var(--accent);
        }

        /* ===== SLIDE TYPE: TRAFFIC-LIGHT ===== */
        .slide-traffic {
            width: 100%;
            max-width: 1000px;
        }

        .slide-traffic h2 {
            text-align: center;
            font-size: 1.8rem;
            margin-bottom: 2rem;
        }

        .traffic-grid {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 1rem;
        }

        .traffic-col {
            border-radius: 12px;
            padding: 1.2rem;
        }

        .traffic-col.green {
            background: rgba(34, 197, 94, 0.15);
            border: 2px solid var(--green);
        }

        .traffic-col.yellow {
            background: rgba(234, 179, 8, 0.15);
            border: 2px solid var(--yellow);
        }

        .traffic-col.red {
            background: rgba(239, 68, 68, 0.15);
            border: 2px solid var(--red);
        }

        .traffic-header {
            font-weight: 700;
            font-size: 1.1rem;
            margin-bottom: 1rem;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .traffic-col.green .traffic-header {
            color: var(--green);
        }

        .traffic-col.yellow .traffic-header {
            color: var(--yellow);
        }

        .traffic-col.red .traffic-header {
            color: var(--red);
        }

        .traffic-list {
            list-style: none;
        }

        .traffic-list li {
            padding: 0.5rem 0;
            border-bottom: 1px solid var(--border);
            font-size: 0.85rem;
        }

        .traffic-list li:last-child {
            border-bottom: none;
        }

        /* ===== SLIDE TYPE: INCIDENTS ===== */
        .slide-incidents {
            width: 100%;
            max-width: 1200px;
        }

        .slide-incidents h2 {
            color: var(--yellow);
            font-size: clamp(1.8rem, 4vw, 2.5rem);
            margin-bottom: 0.5rem;
        }

        .slide-incidents .subtitle {
            opacity: 0.8;
            margin-bottom: 2.5rem;
            font-size: 1.1rem;
        }

        .incidents-grid {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 1.5rem;
        }

        @media (max-width: 900px) {
            .incidents-grid {
                grid-template-columns: 1fr;
            }
        }

        .incident-card {
            background: var(--card-bg);
            border: 2px solid var(--red);
            border-radius: 16px;
            padding: 1.8rem;
            cursor: pointer;
            transition: all 0.3s;
            text-align: left;
        }

        .incident-card:hover {
            border-color: var(--red);
            transform: translateY(-4px);
            box-shadow: 0 8px 24px rgba(239, 68, 68, 0.2);
        }

        .incident-icon {
            font-size: 2rem;
            margin-bottom: 0.5rem;
        }

        .incident-name {
            font-weight: 700;
            font-size: 1.2rem;
            margin: 0.5rem 0;
        }

        .incident-age {
            color: var(--red);
            font-weight: 700;
            font-size: 1.1rem;
        }

        .incident-platform {
            font-size: 0.9rem;
            opacity: 0.7;
            margin-top: 0.3rem;
        }

        .incident-desc {
            margin-top: 1rem;
            font-size: 0.95rem;
            line-height: 1.6;
            opacity: 0.9;
        }

        /* ===== SLIDE TYPE: TOOL-LINKS ===== */
        .slide-tools {
            text-align: center;
            width: 100%;
            max-width: 700px;
        }

        .slide-tools h2 {
            font-size: 1.8rem;
            margin-bottom: 2rem;
        }

        .tools-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 1rem;
        }

        .tool-card {
            background: linear-gradient(135deg, rgba(34, 197, 94, 0.1), rgba(34, 197, 94, 0.05));
            border: 2px solid var(--green);
            border-radius: 14px;
            padding: 1.5rem;
            text-decoration: none;
            color: var(--text);
            transition: all 0.3s;
        }

        .tool-card:hover {
            transform: translateY(-4px);
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
        }

        .tool-icon {
            font-size: 2.5rem;
            margin-bottom: 1rem;
        }

        .tool-name {
            font-size: 1.2rem;
            font-weight: 700;
            margin-bottom: 0.5rem;
        }

        .tool-desc {
            font-size: 0.9rem;
            opacity: 0.7;
        }

        /* ===== SLIDE TYPE: PROMPT-DEMO ===== */
        .slide-prompt-demo {
            text-align: center;
            width: 100%;
            max-width: 900px;
        }

        .slide-prompt-demo h2 {
            font-size: 1.8rem;
            margin-bottom: 0.5rem;
            background: linear-gradient(135deg, var(--accent2), #06b6d4);
            -webkit-background-clip: text;
            background-clip: text;
            -webkit-text-fill-color: transparent;
        }

        .slide-prompt-demo .subtitle {
            opacity: 0.7;
            margin-bottom: 1.5rem;
        }

        .prompt-box {
            background: #1a1a2e;
            border: 2px solid var(--accent2);
            border-radius: 12px;
            padding: 1.5rem;
            text-align: left;
            position: relative;
            margin-bottom: 1.5rem;
        }

        .prompt-box pre {
            font-family: 'JetBrains Mono', monospace;
            font-size: 0.95rem;
            line-height: 1.7;
            white-space: pre-wrap;
            word-wrap: break-word;
            color: #e2e8f0;
            margin: 0;
        }

        .prompt-box .placeholder {
            color: var(--accent);
            font-weight: 700;
        }

        .copy-btn {
            position: absolute;
            top: 0.8rem;
            right: 0.8rem;
            background: var(--accent2);
            border: none;
            color: white;
            padding: 0.4rem 0.8rem;
            border-radius: 6px;
            cursor: pointer;
            font-size: 0.8rem;
            transition: all 0.2s;
        }

        .copy-btn:hover {
            background: #9333ea;
        }

        .copy-btn.copied {
            background: var(--green);
        }

        .prompt-example {
            background: rgba(34, 197, 94, 0.1);
            border: 1px solid var(--green);
            border-radius: 10px;
            padding: 1rem;
            text-align: left;
        }

        .prompt-example-label {
            color: var(--green);
            font-weight: 600;
            font-size: 0.85rem;
            margin-bottom: 0.5rem;
        }

        .prompt-example-text {
            font-style: italic;
            opacity: 0.9;
        }

        .prompt-why {
            margin-top: 1.5rem;
            background: rgba(168, 85, 247, 0.1);
            border-left: 4px solid var(--accent2);
            padding: 1rem;
            border-radius: 0 8px 8px 0;
            text-align: left;
            font-size: 0.9rem;
        }

        /* ===== SLIDE TYPE: VIDEO-LINK ===== */
        .slide-video-link {
            text-align: center;
            width: 100%;
            max-width: 700px;
        }

        .slide-video-link h2 {
            font-size: 2.5rem;
            margin-bottom: 0.5rem;
        }

        .slide-video-link .subtitle {
            opacity: 0.7;
            margin-bottom: 2rem;
            font-size: 1.2rem;
        }

        .video-play-button {
            display: inline-flex;
            flex-direction: column;
            align-items: center;
            gap: 1rem;
            padding: 2rem 4rem;
            background: linear-gradient(135deg, var(--accent1), var(--accent2));
            border-radius: 20px;
            text-decoration: none;
            color: white;
            transition: all 0.3s ease;
            box-shadow: 0 8px 32px rgba(168, 85, 247, 0.3);
        }

        .video-play-button:hover {
            transform: scale(1.05);
            box-shadow: 0 12px 48px rgba(168, 85, 247, 0.5);
        }

        .play-icon {
            font-size: 4rem;
            line-height: 1;
        }

        .play-text {
            font-size: 1.2rem;
            font-weight: 600;
        }

        .video-description {
            margin-top: 2rem;
            opacity: 0.8;
            max-width: 500px;
            margin-left: auto;
            margin-right: auto;
        }

        /* ===== SLIDE TYPE: STEP-SLIDE ===== */
        .slide-step {
            text-align: center;
            width: 100%;
            max-width: 1000px;
            position: relative;
        }

        .step-container {
            min-height: 60vh;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            cursor: pointer;
        }

        .step-content {
            display: none;
            animation: fadeInStep 0.5s ease;
        }

        .step-content.active {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 1.5rem;
        }

        @keyframes fadeInStep {
            from {
                opacity: 0;
                transform: translateY(20px);
            }

            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .step-title {
            font-size: clamp(2.5rem, 5vw, 4rem);
            font-weight: 900;
            background: linear-gradient(135deg, var(--accent), var(--green));
            -webkit-background-clip: text;
            background-clip: text;
            -webkit-text-fill-color: transparent;
        }

        .step-subtitle {
            font-size: clamp(1.5rem, 3vw, 2.5rem);
            color: var(--green);
            font-weight: 600;
        }

        .step-definition {
            font-size: clamp(1.3rem, 2.5vw, 2rem);
            max-width: 700px;
            line-height: 1.6;
            color: #d4a574;
        }

        .step-list {
            text-align: left;
            max-width: 800px;
            list-style: disc;
            padding-left: 1.5rem;
        }

        .step-list li {
            margin-bottom: 0.8rem;
            font-size: clamp(0.9rem, 1.5vw, 1.2rem);
            line-height: 1.5;
        }

        .step-list li strong {
            color: var(--text);
        }

        .step-list li span {
            opacity: 0.8;
        }

        .step-footer {
            color: var(--red);
            font-size: clamp(1.2rem, 2vw, 1.6rem);
            font-weight: 600;
            font-style: italic;
            margin-top: 1rem;
        }

        .step-dots {
            display: flex;
            gap: 0.8rem;
            justify-content: center;
            margin-top: 2rem;
        }

        .step-dot {
            width: 12px;
            height: 12px;
            border-radius: 50%;
            background: rgba(255, 255, 255, 0.3);
            cursor: pointer;
            transition: all 0.3s;
        }

        .step-dot.active {
            background: var(--accent);
            transform: scale(1.3);
        }

        .step-hint {
            position: absolute;
            bottom: 2rem;
            left: 50%;
            transform: translateX(-50%);
            opacity: 0.5;
            font-size: 0.9rem;
        }

        /* ===== SLIDE TYPE: TOKEN-DEMO ===== */
        .slide-token-demo {
            text-align: center;
            width: 100%;
            max-width: 800px;
        }

        .slide-token-demo h2 {
            font-size: 1.8rem;
            margin-bottom: 0.5rem;
            background: linear-gradient(135deg, var(--accent), var(--accent2));
            -webkit-background-clip: text;
            background-clip: text;
            -webkit-text-fill-color: transparent;
        }

        .slide-token-demo .desc {
            opacity: 0.7;
            margin-bottom: 2rem;
        }

        .demo-box {
            background: var(--surface);
            border-radius: 16px;
            padding: 2rem;
        }

        .prompt-area {
            font-family: 'JetBrains Mono', monospace;
            font-size: 1.5rem;
            margin-bottom: 1.5rem;
        }

        .predicted {
            color: var(--green);
            opacity: 0;
            transition: opacity 0.3s;
        }

        .predicted.visible {
            opacity: 1;
        }

        .token-cursor {
            display: inline-block;
            width: 0.6em;
            height: 1.2em;
            background: var(--accent);
            margin-left: 0.1em;
            animation: blink 1s step-end infinite;
            vertical-align: middle;
        }

        .options {
            display: flex;
            gap: 0.8rem;
            flex-wrap: wrap;
            justify-content: center;
            margin-bottom: 1.5rem;
        }

        .option {
            background: rgba(249, 115, 22, 0.15);
            border: 2px solid var(--accent);
            border-radius: 8px;
            padding: 0.6rem 1.2rem;
            cursor: pointer;
            transition: all 0.2s;
            font-family: 'JetBrains Mono', monospace;
        }

        .option:hover {
            background: var(--accent);
            color: var(--bg);
        }

        .option.selected {
            background: var(--green);
            border-color: var(--green);
            color: var(--bg);
        }

        .probability {
            font-size: 0.75rem;
            opacity: 0.7;
            margin-left: 0.5rem;
        }

        .explanation {
            background: rgba(168, 85, 247, 0.1);
            border-left: 4px solid var(--accent2);
            padding: 1rem;
            border-radius: 0 8px 8px 0;
            text-align: left;
            font-size: 0.95rem;
            line-height: 1.6;
        }

        .reset-btn {
            margin-top: 1rem;
            background: rgba(255, 255, 255, 0.1);
            border: none;
            color: white;
            padding: 0.5rem 1rem;
            border-radius: 6px;
            cursor: pointer;
        }

        .reset-btn:hover {
            background: rgba(255, 255, 255, 0.2);
        }

        /* Modal for incidents */
        .modal-overlay {
            position: fixed;
            inset: 0;
            background: rgba(0, 0, 0, 0.9);
            display: none;
            align-items: center;
            justify-content: center;
            z-index: 200;
            padding: 2rem;
        }

        .modal-overlay.active {
            display: flex;
        }

        .modal {
            background: var(--surface);
            border-radius: 16px;
            padding: 2rem;
            max-width: 600px;
            max-height: 80vh;
            overflow-y: auto;
        }

        .modal h3 {
            color: var(--red);
            margin-bottom: 1rem;
        }

        .modal p {
            line-height: 1.7;
            margin-bottom: 1rem;
        }

        .modal a {
            color: var(--yellow);
        }

        /* Source button */
        .source-btn {
            position: fixed;
            bottom: 1rem;
            right: 1rem;
            background: rgba(255, 255, 255, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.2);
            color: white;
            padding: 0.5rem 1rem;
            border-radius: 8px;
            cursor: pointer;
            font-size: 0.8rem;
            z-index: 101;
            display: flex;
            align-items: center;
            gap: 0.4rem;
            transition: all 0.2s;
        }

        .source-btn:hover {
            background: rgba(255, 255, 255, 0.2);
            border-color: var(--yellow);
        }

        .sources-modal h3 {
            color: var(--yellow);
            margin-bottom: 1rem;
        }

        .sources-modal .source-item {
            padding: 0.8rem 0;
            border-bottom: 1px solid var(--border);
        }

        .sources-modal .source-item:last-child {
            border-bottom: none;
        }

        .sources-modal .source-name {
            font-weight: 600;
            margin-bottom: 0.3rem;
        }

        .sources-modal .source-url {
            font-size: 0.85rem;
            color: var(--yellow);
            word-break: break-all;
        }

        @media (max-width: 768px) {

            .traffic-grid,
            .quad-grid {
                grid-template-columns: 1fr;
            }
        }

        /* Large screen optimization for auditorium presentations */
        @media (min-width: 1200px) {
            .slide-content {
                padding: 3rem;
            }

            /* Bigger titles */
            .slide-title-type h1 {
                font-size: clamp(4rem, 8vw, 8rem);
            }

            .slide-title-type .subtitle {
                font-size: clamp(1.5rem, 3vw, 2.5rem);
            }

            /* Bigger stats */
            .slide-stat .stat-value {
                font-size: clamp(10rem, 25vw, 20rem);
            }

            .slide-stat .stat-label {
                font-size: clamp(1.8rem, 4vw, 3rem);
                max-width: 1000px;
            }

            /* Bigger quotes */
            .slide-quote {
                max-width: 1200px;
            }

            .slide-quote .quote-text {
                font-size: clamp(2rem, 4vw, 3.5rem);
            }

            .slide-quote .quote-author {
                font-size: 1.5rem;
            }

            /* Bigger grid cards */
            .grid-cards {
                gap: 2rem;
            }

            .grid-card {
                padding: 2.5rem;
            }

            .grid-card-icon {
                font-size: 4rem;
            }

            .grid-card-title {
                font-size: 1.6rem;
            }

            .grid-card-desc {
                font-size: 1.2rem;
            }

            /* Bigger quad flip cards */
            .quad-card {
                min-height: 280px;
            }

            .quad-icon {
                font-size: 4rem;
            }

            .quad-title {
                font-size: 1.4rem;
            }

            .quad-back {
                font-size: 1.3rem;
            }

            /* Bigger traffic light */
            .traffic-column h3 {
                font-size: 1.6rem;
            }

            .traffic-item {
                font-size: 1.2rem;
                padding: 1rem;
            }

            /* Bigger prompt demo */
            .slide-prompt-demo {
                max-width: 1100px;
            }

            .prompt-box pre {
                font-size: 1.3rem;
            }

            /* Bigger token demo */
            .slide-token-demo {
                max-width: 1000px;
            }

            .demo-box {
                padding: 3rem;
            }

            .prompt-area {
                font-size: 2rem;
            }

            .option {
                font-size: 1.4rem;
                padding: 1.2rem 2rem;
            }
        }
    </style>
</head>

<body>
    <div class="card-view" id="cardView"></div>

    <div class="slide-view" id="slideView">
        <button class="close-btn" onclick="closeSlide()">‚úï</button>
        <button class="dimmer-btn" id="dimmerBtn" onclick="toggleDimmer()" title="Dimma bakgrund">üåô</button>
        <div class="slide-content" id="slideContent"></div>
        <div class="slide-id-display" id="slideIdDisplay"></div>
    </div>

    <div class="modal-overlay" id="incidentModal" onclick="closeIncidentModal(event)">
        <div class="modal" id="incidentModalContent" onclick="event.stopPropagation()"></div>
    </div>

    <div class="modal-overlay" id="sourcesModal" onclick="closeSourcesModal(event)">
        <div class="modal sources-modal" id="sourcesModalContent" onclick="event.stopPropagation()"></div>
    </div>

    <button class="source-btn" id="sourceBtn" style="display:none" onclick="showSources()">
        üìö K√§llor
    </button>

    <script>
        let slidesData = [];
        let currentSlideIndex = 0;

        // Load slides from JSON
        async function loadSlides() {
            try {
                const response = await fetch('slides.json');
                const data = await response.json();
                slidesData = data.slides;
                renderCardView();
            } catch (error) {
                console.error('Failed to load slides:', error);
                document.getElementById('cardView').innerHTML = '<p style="padding:2rem;opacity:0.5">Kunde inte ladda slides.json</p>';
            }
        }

        // Render card grid
        function renderCardView() {
            const container = document.getElementById('cardView');
            container.innerHTML = slidesData.map((slide, index) => {
                const bgStyle = slide.background
                    ? `background-image: linear-gradient(rgba(10, 10, 30, 0.5), rgba(10, 10, 30, 0.7)), url('${slide.background}'); background-size: cover; background-position: center;`
                    : '';
                const cardTitle = getCardTitle(slide);
                return `
                <div class="slide-card" onclick="openSlide(${index})" style="${bgStyle}">
                    <span class="card-type">${slide.type}</span>
                    <span class="card-icon">${slide.background ? '' : getTypeIcon(slide.type)}</span>
                    <span class="card-title">${cardTitle}</span>
                    <span class="card-id">${slide.id}</span>
                </div>
            `}).join('');
        }

        function getCardTitle(slide) {
            // Prioritera title, sedan author f√∂r quotes, sedan andra f√§lt
            if (slide.title) return slide.title;
            if (slide.type === 'quote' && slide.author) return slide.author;
            if (slide.name) return slide.name;
            if (slide.value) return slide.value;
            if (slide.type === 'quote' && slide.text) {
                // Extrahera f√∂rsta 30 tecken av texten
                const cleanText = slide.text.replace(/\*/g, '').substring(0, 35);
                return cleanText + '...';
            }
            return 'Slide';
        }

        function getTypeIcon(type) {
            const icons = {
                'title': 'üé¨',
                'presenter': 'üë§',
                'stat': 'üìä',
                'quote': 'üí¨',
                'grid': 'üì¶',
                'quad-flip': 'üîÑ',
                'traffic-light': 'üö¶',
                'incidents': '‚ö†Ô∏è',
                'tool-links': 'üîß',
                'token-demo': 'üß†',
                'step-slide': 'üìñ',
                'prompt-demo': '‚ú®',
                'video-link': 'üé¨'
            };
            return icons[type] || 'üìÑ';
        }

        // Open slide in fullscreen
        function openSlide(index) {
            currentSlideIndex = index;
            renderCurrentSlide();
            document.getElementById('cardView').classList.add('hidden');
            document.getElementById('slideView').classList.add('active');
        }

        function closeSlide() {
            document.getElementById('slideView').classList.remove('active');
            document.getElementById('slideView').classList.remove('dimmed');
            document.getElementById('dimmerBtn').classList.remove('active');
            document.getElementById('cardView').classList.remove('hidden');
        }

        function toggleDimmer() {
            const slideView = document.getElementById('slideView');
            const dimmerBtn = document.getElementById('dimmerBtn');
            slideView.classList.toggle('dimmed');
            dimmerBtn.classList.toggle('active');
        }

        function prevSlide() {
            if (currentSlideIndex > 0) {
                currentSlideIndex--;
                renderCurrentSlide();
            }
        }

        function nextSlide() {
            if (currentSlideIndex < slidesData.length - 1) {
                currentSlideIndex++;
                renderCurrentSlide();
            }
        }

        function renderCurrentSlide() {
            const slide = slidesData[currentSlideIndex];
            const content = document.getElementById('slideContent');
            const slideView = document.getElementById('slideView');
            document.getElementById('slideIdDisplay').textContent = `${currentSlideIndex + 1}/${slidesData.length} ‚Ä¢ ${slide.id}`;

            // Apply background image if specified
            if (slide.background) {
                slideView.style.backgroundImage = `linear-gradient(rgba(10, 10, 30, 0.7), rgba(10, 10, 30, 0.8)), url('${slide.background}')`;
                slideView.style.backgroundSize = 'cover';
                slideView.style.backgroundPosition = 'center';
            } else {
                slideView.style.backgroundImage = '';
            }

            switch (slide.type) {
                case 'title': content.innerHTML = renderTitle(slide); break;
                case 'presenter': content.innerHTML = renderPresenter(slide); break;
                case 'stat': content.innerHTML = renderStat(slide); break;
                case 'quote': content.innerHTML = renderQuote(slide); break;
                case 'grid': content.innerHTML = renderGrid(slide); break;
                case 'quad-flip': content.innerHTML = renderQuadFlip(slide); break;
                case 'modal-cards': content.innerHTML = renderModalCards(slide); break;
                case 'traffic-light': content.innerHTML = renderTrafficLight(slide); break;
                case 'incidents': content.innerHTML = renderIncidents(slide); break;
                case 'tool-links': content.innerHTML = renderToolLinks(slide); break;
                case 'token-demo': content.innerHTML = renderTokenDemo(slide); break;
                case 'prompt-demo': content.innerHTML = renderPromptDemo(slide); break;
                case 'video-link': content.innerHTML = renderVideoLink(slide); break;
                case 'step-slide': content.innerHTML = renderStepSlide(slide); break;
                default: content.innerHTML = `<p>Unknown slide type: ${slide.type}</p>`;
            }
            updateSourceButton();
        }

        // ===== SLIDE RENDERERS =====
        function renderTitle(s) {
            return `<div class="slide-title-type">
                <h1>${s.title}</h1>
                <div class="subtitle">${s.subtitle || ''}</div>
                <div class="meta">${s.meta || ''}</div>
            </div>`;
        }

        function renderPresenter(s) {
            const avatarContent = s.avatar
                ? `<img src="${s.avatar}" alt="${s.name}">`
                : 'üë§';
            return `<div class="slide-presenter">
                <div class="avatar">${avatarContent}</div>
                <h2>${s.name}</h2>
                <div class="title-org">${s.title} ‚Ä¢ ${s.org}</div>
                <div class="bio">${s.bio || ''}</div>
                ${s.contact ? `<div class="contact">${s.contact}</div>` : ''}
            </div>`;
        }

        function renderStat(s) {
            return `<div class="slide-stat">
                <div class="stat-value">${s.value}</div>
                <div class="stat-label">${s.label}</div>
                <div class="stat-source">K√§lla: ${s.source}</div>
            </div>`;
        }

        function renderQuote(s) {
            const isTypewriter = s.style === 'typewriter';
            const rawText = s.text;
            if (isTypewriter) {
                // Return container, will animate after render
                setTimeout(() => typewriterAnimate(rawText, s.author), 100);
                return `<div class="slide-quote typewriter">
                    <div class="quote-text" id="typewriterText"></div>
                    <div class="quote-author" id="typewriterAuthor" style="opacity:0"></div>
                </div>`;
            } else {
                const text = rawText.replace(/\*([^*]+)\*/g, '<span class="highlight">$1</span>');
                return `<div class="slide-quote">
                    <div class="quote-text">"${text}"</div>
                    ${s.author ? `<div class="quote-author">‚Äî ${s.author}</div>` : ''}
                </div>`;
            }
        }

        function typewriterAnimate(rawText, author) {
            const container = document.getElementById('typewriterText');
            const authorEl = document.getElementById('typewriterAuthor');
            if (!container) return;

            // Process text to handle *highlights*
            let chars = [];
            let inHighlight = false;
            let i = 0;
            while (i < rawText.length) {
                if (rawText[i] === '*') {
                    inHighlight = !inHighlight;
                    i++;
                } else {
                    chars.push({ char: rawText[i], highlight: inHighlight });
                    i++;
                }
            }

            container.innerHTML = '"';
            let charIndex = 0;

            function typeNext() {
                if (charIndex < chars.length) {
                    const c = chars[charIndex];
                    if (c.highlight) {
                        container.innerHTML = container.innerHTML.replace(/<span class="cursor"><\/span>$/, '');
                        container.innerHTML += `<span class="highlight">${c.char}</span><span class="cursor"></span>`;
                    } else {
                        container.innerHTML = container.innerHTML.replace(/<span class="cursor"><\/span>$/, '');
                        container.innerHTML += c.char + '<span class="cursor"></span>';
                    }
                    charIndex++;
                    setTimeout(typeNext, 30 + Math.random() * 40);
                } else {
                    container.innerHTML = container.innerHTML.replace(/<span class="cursor"><\/span>$/, '');
                    container.innerHTML += '"<span class="cursor"></span>';
                    if (author && authorEl) {
                        authorEl.textContent = '‚Äî ' + author;
                        authorEl.style.opacity = '0.6';
                    }
                }
            }

            container.innerHTML = '"<span class="cursor"></span>';
            setTimeout(typeNext, 500);
        }

        function renderGrid(s) {
            return `<div class="slide-grid">
                <h2>${s.title}</h2>
                <div class="grid-cards">
                    ${s.cards.map(c => `
                        <div class="grid-card">
                            <div class="grid-card-icon">${c.icon}</div>
                            <div class="grid-card-title">${c.title}</div>
                            <div class="grid-card-desc">${c.desc}</div>
                        </div>
                    `).join('')}
                </div>
            </div>`;
        }

        function renderQuadFlip(s) {
            return `<div class="slide-quad">
                <h2>‚ö†Ô∏è ${s.title}</h2>
                <div class="quad-grid">
                    ${s.cards.map(c => `
                        <div class="quad-card" onclick="this.classList.toggle('flipped')">
                            <div class="quad-front">
                                <div class="quad-icon">${c.icon}</div>
                                <div class="quad-title">${c.front}</div>
                            </div>
                            <div class="quad-back">${c.back}</div>
                        </div>
                    `).join('')}
                </div>
            </div>`;
        }

        function renderModalCards(s) {
            return `<div class="slide-modal-cards">
                <h2>${s.title}</h2>
                <div class="modal-cards-grid">
                    ${s.cards.map((c, i) => `
                        <div class="modal-card" onclick="showCardModal(${currentSlideIndex}, ${i})">
                            <div class="modal-card-icon">
                                ${c.icon.endsWith('.png') ? `<img src="${c.icon}" alt="${c.front}">` : c.icon}
                            </div>
                            <div class="modal-card-title">${c.front}</div>
                        </div>
                    `).join('')}
                </div>
            </div>`;
        }

        function showCardModal(slideIdx, cardIdx) {
            const card = slidesData[slideIdx].cards[cardIdx];
            const backText = card.back.replace(/\\n/g, '<br>').replace(/\*\*(.+?)\*\*/g, '<strong>$1</strong>');
            document.getElementById('incidentModalContent').innerHTML = `
                <div class="card-modal-content">
                    <div class="card-modal-icon">
                        ${card.icon.endsWith('.png') ? `<img src="${card.icon}" alt="${card.front}">` : card.icon}
                    </div>
                    <h3>${card.front}</h3>
                    <div class="card-modal-text">${backText}</div>
                </div>
            `;
            document.getElementById('incidentModal').classList.add('active');
        }

        function renderTrafficLight(s) {
            return `<div class="slide-traffic">
                <h2>${s.title}</h2>
                <div class="traffic-grid">
                    <div class="traffic-col green">
                        <div class="traffic-header">‚úÖ Gr√∂nt ljus</div>
                        <ul class="traffic-list">${s.green.map(i => `<li>${i}</li>`).join('')}</ul>
                    </div>
                    <div class="traffic-col yellow">
                        <div class="traffic-header">‚ö†Ô∏è Gult ljus</div>
                        <ul class="traffic-list">${s.yellow.map(i => `<li>${i}</li>`).join('')}</ul>
                    </div>
                    <div class="traffic-col red">
                        <div class="traffic-header">üõë R√∂tt ljus</div>
                        <ul class="traffic-list">${s.red.map(i => `<li>${i}</li>`).join('')}</ul>
                    </div>
                </div>
            </div>`;
        }

        function renderIncidents(s) {
            return `<div class="slide-incidents">
                <h2>‚ö†Ô∏è ${s.title}</h2>
                <div class="subtitle">${s.subtitle}</div>
                <div class="incidents-grid">
                    ${s.cases.map((c, i) => `
                        <div class="incident-card" onclick="showIncident(${currentSlideIndex}, ${i})">
                            <div class="incident-icon">${c.icon}</div>
                            <div class="incident-name">${c.name}</div>
                            <div class="incident-age">${c.age} √•r</div>
                            <div class="incident-platform">${c.platform} ‚Ä¢ ${c.date}</div>
                            <div class="incident-desc">${c.description}</div>
                        </div>
                    `).join('')}
                </div>
            </div>`;
        }

        function showIncident(slideIdx, caseIdx) {
            const incident = slidesData[slideIdx].cases[caseIdx];
            document.getElementById('incidentModalContent').innerHTML = `
                <h3>${incident.icon} ${incident.name}, ${incident.age} √•r</h3>
                <p>${incident.description}</p>
                ${incident.source ? `<p><a href="${incident.source}" target="_blank">L√§s mer ‚Üí</a></p>` : ''}
            `;
            document.getElementById('incidentModal').classList.add('active');
        }

        function closeIncidentModal(e) {
            document.getElementById('incidentModal').classList.remove('active');
        }

        function showSources() {
            const slide = slidesData[currentSlideIndex];
            if (!slide.sources || slide.sources.length === 0) return;

            const content = document.getElementById('sourcesModalContent');
            content.innerHTML = `
                <h3>üìö K√§llor</h3>
                ${slide.sources.map(s => `
                    <div class="source-item">
                        <div class="source-name">${s.name}</div>
                        ${s.url ? `<a href="${s.url}" target="_blank" class="source-url">${s.url}</a>` : ''}
                    </div>
                `).join('')}
            `;
            document.getElementById('sourcesModal').classList.add('active');
        }

        function closeSourcesModal(e) {
            document.getElementById('sourcesModal').classList.remove('active');
        }

        function updateSourceButton() {
            const slide = slidesData[currentSlideIndex];
            const btn = document.getElementById('sourceBtn');
            if (slide.sources && slide.sources.length > 0) {
                btn.style.display = 'flex';
            } else {
                btn.style.display = 'none';
            }
        }

        function renderPromptDemo(s) {
            return `<div class="slide-prompt-demo">
                <h2>üß† ${s.title}</h2>
                <div class="subtitle">${s.subtitle || 'En prompt att kopiera och anv√§nda i Gemini'}</div>
                <div class="prompt-box">
                    <button class="copy-btn" onclick="copyPrompt(this, '${s.id}')">üìã Kopiera</button>
                    <pre id="prompt-${s.id}">${s.prompt.replace(/\[([^\]]+)\]/g, '<span class="placeholder">[$1]</span>')}</pre>
                </div>
                ${s.example_topic ? `
                <div class="prompt-example">
                    <div class="prompt-example-label">üí° Exempel p√• √§mne:</div>
                    <div class="prompt-example-text">"${s.example_topic}"</div>
                </div>
                ` : ''}
                ${s.why ? `
                <div class="prompt-why">
                    <strong>Varf√∂r?</strong> ${s.why}
                </div>
                ` : ''}
            </div>`;
        }

        function copyPrompt(btn, id) {
            const pre = document.getElementById('prompt-' + id);
            const text = pre.innerText.replace(/\s+/g, ' ').trim();
            navigator.clipboard.writeText(text).then(() => {
                btn.textContent = '‚úÖ Kopierad!';
                btn.classList.add('copied');
                setTimeout(() => {
                    btn.textContent = 'üìã Kopiera';
                    btn.classList.remove('copied');
                }, 2000);
            });
        }

        function renderVideoLink(s) {
            return `<div class="slide-video-link">
                <h2>${s.icon || 'üé¨'} ${s.title}</h2>
                <div class="subtitle">${s.subtitle || ''}</div>
                <a href="${s.url}" target="_blank" class="video-play-button">
                    <div class="play-icon">‚ñ∂</div>
                    <div class="play-text">Spela video</div>
                </a>
                <p class="video-description">${s.description || ''}</p>
            </div>`;
        }

        // ===== STEP-SLIDE RENDERER =====
        let currentStepIndex = 0;

        function renderStepSlide(s) {
            currentStepIndex = 0;
            let html = `<div class="slide-step">
                <div class="step-container" onclick="nextStep('${s.id}')">`;

            s.steps.forEach((step, i) => {
                html += `<div class="step-content ${i === 0 ? 'active' : ''}" data-step="${i}">`;

                if (step.type === 'headline') {
                    html += `<div class="step-title">${step.title}</div>
                             <div class="step-subtitle">${step.subtitle}</div>`;
                } else if (step.type === 'definition') {
                    html += `<div class="step-definition">${step.text}</div>`;
                } else if (step.type === 'list') {
                    html += `<ul class="step-list">`;
                    step.items.forEach(item => {
                        html += `<li><strong>${item.title}:</strong> <span>${item.desc}</span></li>`;
                    });
                    html += `</ul>`;
                    if (step.footer) {
                        html += `<div class="step-footer">${step.footer}</div>`;
                    }
                }

                html += `</div>`;
            });

            html += `</div>
                <div class="step-dots">
                    ${s.steps.map((_, i) => `<div class="step-dot ${i === 0 ? 'active' : ''}" onclick="goToStep(${i}, event)"></div>`).join('')}
                </div>
                <div class="step-hint">üëÜ Klicka f√∂r att g√• vidare</div>
            </div>`;

            return html;
        }

        function nextStep(slideId) {
            const slide = slidesData.find(s => s.id === slideId);
            if (!slide || !slide.steps) return;

            const totalSteps = slide.steps.length;
            currentStepIndex = (currentStepIndex + 1) % totalSteps;
            updateStepDisplay();
        }

        function goToStep(stepIndex, event) {
            event.stopPropagation();
            currentStepIndex = stepIndex;
            updateStepDisplay();
        }

        function updateStepDisplay() {
            const steps = document.querySelectorAll('.step-content');
            const dots = document.querySelectorAll('.step-dot');

            steps.forEach((step, i) => {
                step.classList.toggle('active', i === currentStepIndex);
            });
            dots.forEach((dot, i) => {
                dot.classList.toggle('active', i === currentStepIndex);
            });
        }

        function renderToolLinks(s) {
            return `<div class="slide-tools">
                <h2>${s.title}</h2>
                <div class="tools-grid">
                    ${s.tools.map(t => `
                        <a href="${t.url}" target="_blank" class="tool-card">
                            <div class="tool-icon">${t.icon}</div>
                            <div class="tool-name">${t.name}</div>
                            <div class="tool-desc">${t.desc}</div>
                        </a>
                    `).join('')}
                </div>
            </div>`;
        }

        function renderTokenDemo(s) {
            return `<div class="slide-token-demo">
                <h2>${s.title}</h2>
                <div class="desc">${s.description}</div>
                <div class="demo-box">
                    <div class="prompt-area">
                        "${s.prompt}<span class="predicted" id="w1"></span><span class="predicted" id="w2"></span><span class="predicted" id="w3"></span><span class="token-cursor" id="tokenCursor"></span>"
                    </div>
                    <div class="options" id="tokenOptions">
                        <div class="option" onclick="selectToken(this,'pizza')">pizza <span class="probability">34%</span></div>
                        <div class="option" onclick="selectToken(this,'glass')">glass <span class="probability">28%</span></div>
                        <div class="option" onclick="selectToken(this,'mat')">mat <span class="probability">19%</span></div>
                        <div class="option" onclick="selectToken(this,'k√§rlek')">k√§rlek <span class="probability">8%</span></div>
                    </div>
                    <div class="explanation" id="tokenExplanation">
                        <strong>üëÜ Klicka p√• ett ord!</strong><br>AI:n ser "${s.prompt}" och ber√§knar sannolikheten f√∂r varje m√∂jligt n√§sta ord.
                    </div>
                    <button class="reset-btn" onclick="resetTokenDemo()">‚Üª B√∂rja om</button>
                </div>
            </div>`;
        }

        let tokenStep = 0;
        let selectedWords = [];

        // Complete branching tree: each word choice affects next options
        const tokenTree = {
            // Step 1: "Jag √§lskar att √§ta ___"
            start: [
                { word: 'pizza', prob: '34%' },
                { word: 'glass', prob: '28%' },
                { word: 'mat', prob: '19%' },
                { word: 'frukt', prob: '11%' }
            ],
            // Step 2: depends on step 1
            pizza: [
                { word: 'varje', prob: '41%' },
                { word: 'med', prob: '28%' },
                { word: 'p√•', prob: '18%' },
                { word: 'efter', prob: '8%' }
            ],
            glass: [
                { word: 'p√•', prob: '38%' },
                { word: 'under', prob: '26%' },
                { word: 'n√§r', prob: '21%' },
                { word: 'med', prob: '12%' }
            ],
            mat: [
                { word: 'som', prob: '35%' },
                { word: 'tillsammans', prob: '28%' },
                { word: 'med', prob: '22%' },
                { word: 'fr√•n', prob: '12%' }
            ],
            frukt: [
                { word: 'och', prob: '42%' },
                { word: 'varje', prob: '26%' },
                { word: 'till', prob: '18%' },
                { word: 'p√•', prob: '11%' }
            ],
            // Step 3: depends on step 2
            varje: [
                { word: 'dag', prob: '52%' },
                { word: 'kv√§ll', prob: '24%' },
                { word: 'fredag', prob: '14%' },
                { word: 'vecka', prob: '7%' }
            ],
            med: [
                { word: 'v√§nner', prob: '38%' },
                { word: 'familjen', prob: '32%' },
                { word: 'extra', prob: '18%' },
                { word: 'ost', prob: '9%' }
            ],
            p√•: [
                { word: 'sommaren', prob: '44%' },
                { word: 'fredagar', prob: '28%' },
                { word: 'kv√§llen', prob: '17%' },
                { word: 'stranden', prob: '8%' }
            ],
            efter: [
                { word: 'jobbet', prob: '41%' },
                { word: 'tr√§ningen', prob: '32%' },
                { word: 'skolan', prob: '18%' },
                { word: 'middagen', prob: '6%' }
            ],
            under: [
                { word: 'sommaren', prob: '48%' },
                { word: 'helgen', prob: '28%' },
                { word: 'semestern', prob: '16%' },
                { word: 'filmen', prob: '5%' }
            ],
            n√§r: [
                { word: 'solen', prob: '36%' },
                { word: 'det', prob: '31%' },
                { word: 'jag', prob: '22%' },
                { word: 'vi', prob: '8%' }
            ],
            som: [
                { word: 'mamma', prob: '34%' },
                { word: 'farmor', prob: '28%' },
                { word: 'kommer', prob: '22%' },
                { word: 'smakar', prob: '13%' }
            ],
            tillsammans: [
                { word: 'med', prob: '62%' },
                { word: 'i', prob: '18%' },
                { word: 'p√•', prob: '12%' },
                { word: 'hemma', prob: '5%' }
            ],
            fr√•n: [
                { word: 'Sverige', prob: '31%' },
                { word: 'butiken', prob: '28%' },
                { word: 'tr√§dg√•rden', prob: '24%' },
                { word: 'marknaden', prob: '14%' }
            ],
            och: [
                { word: 'gr√∂nsaker', prob: '38%' },
                { word: 'b√§r', prob: '32%' },
                { word: 'n√∂tter', prob: '18%' },
                { word: 'juice', prob: '9%' }
            ],
            till: [
                { word: 'frukost', prob: '42%' },
                { word: 'mellanm√•l', prob: '28%' },
                { word: 'lunch', prob: '18%' },
                { word: 'dessert', prob: '9%' }
            ]
        };

        function selectToken(el, word) {
            if (tokenStep >= 3) return;
            document.querySelectorAll('.option').forEach(o => o.classList.remove('selected'));
            el.classList.add('selected');
            const span = document.getElementById('w' + (tokenStep + 1));
            span.textContent = ' ' + word;
            span.classList.add('visible');
            selectedWords.push(word);
            tokenStep++;

            if (tokenStep >= 3) {
                document.getElementById('tokenOptions').style.display = 'none';
                document.getElementById('tokenCursor').style.display = 'none';
                document.getElementById('tokenExplanation').innerHTML = '<strong>‚ú® Klart!</strong><br><br>S√• fungerar GPT: den gissar n√§sta ord baserat p√• statistiska m√∂nster. <em>Varje ord du valde √§ndrade vilka alternativ som d√∂k upp</em> ‚Äî precis som i verkligheten.';
            } else {
                // Show next set of options based on what was just selected
                setTimeout(() => {
                    const nextOpts = tokenTree[word] || tokenTree.varje;
                    const container = document.getElementById('tokenOptions');
                    container.innerHTML = nextOpts.map(o =>
                        `<div class="option" onclick="selectToken(this,'${o.word}')">${o.word} <span class="probability">${o.prob}</span></div>`
                    ).join('');
                    document.getElementById('tokenExplanation').innerHTML = `<strong>Bra!</strong> Du valde "<em>${word}</em>" ‚Äî nu har kontexten √§ndrats och AI:n ber√§knar nya sannolikheter.`;
                }, 300);
            }
        }

        function resetTokenDemo() {
            tokenStep = 0;
            selectedWords = [];
            ['w1', 'w2', 'w3'].forEach(id => {
                const el = document.getElementById(id);
                if (el) { el.textContent = ''; el.classList.remove('visible'); }
            });
            const cursor = document.getElementById('tokenCursor');
            const opts = document.getElementById('tokenOptions');
            if (cursor) cursor.style.display = 'inline-block';
            if (opts) {
                opts.style.display = 'flex';
                opts.innerHTML = tokenTree.start.map(o =>
                    `<div class="option" onclick="selectToken(this,'${o.word}')">${o.word} <span class="probability">${o.prob}</span></div>`
                ).join('');
            }
            const expl = document.getElementById('tokenExplanation');
            if (expl) expl.innerHTML = '<strong>üëÜ Klicka p√• ett ord!</strong><br>AI:n ser prompten och ber√§knar sannolikheten f√∂r varje m√∂jligt n√§sta ord.';
        }

        // Keyboard navigation - only Escape to close
        document.addEventListener('keydown', (e) => {
            if (!document.getElementById('slideView').classList.contains('active')) return;
            if (e.key === 'Escape') closeSlide();
        });

        // Init
        loadSlides();
    </script>
</body>

</html>